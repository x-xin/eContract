!function(t,i,s){"use strict";function e(t,i){this.element=t,this.$element=s(this.element),this.canvas=!1,this.$canvas=!1,this.ctx=!1,this.drawing=!1,this.currentPos={x:0,y:0},this.lastPos=this.currentPos,this._data=this.$element.data(),this.settings=s.extend({},a,i,this._data),this.init()}t.requestAnimFrame=function(i){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimaitonFrame||function(i){t.setTimeout(i,1e3/60)}}();var n="jqSignature",a={lineColor:"#222222",lineWidth:1,border:"1px dashed #AAAAAA",background:"#FFFFFF",width:"100%",height:"100%",autoFit:!1},h="<canvas></canvas>";e.prototype={init:function(){if(this.$canvas=s(h).appendTo(this.$element),this.$canvas.attr({width:this.settings.width,height:this.settings.height}),this.$canvas.css({boxSizing:"border-box",width:this.settings.width+"px",height:this.settings.height+"px",border:this.settings.border,background:this.settings.background,cursor:"crosshair"}),this.settings.autoFit===!0){this._resizeCanvas();var e=!1;s(t).on("resize",s.proxy(function(t){clearTimeout(e),e=setTimeout(s.proxy(this._resizeCanvas,this),250)},this))}this.canvas=this.$canvas[0],this._resetCanvas(),this.$canvas.on("mousedown touchstart",s.proxy(function(t){this.drawing=!0,this.lastPos=this.currentPos=this._getPosition(t)},this)),this.$canvas.on("mousemove touchmove",s.proxy(function(t){this.currentPos=this._getPosition(t)},this)),this.$canvas.on("mouseup touchend",s.proxy(function(t){this.drawing=!1;var i=s.Event("jq.signature.changed");this.$element.trigger(i)},this)),s(i).on("touchstart touchmove touchend",s.proxy(function(t){t.target===this.canvas&&t.preventDefault()},this));var n=this;!function i(){t.requestAnimFrame(i),n._renderCanvas()}()},clearCanvas:function(){this.canvas.width=this.canvas.width,this._resetCanvas()},getDataURL:function(){return this.canvas.toDataURL("image/png")},_getPosition:function(t){var i,s,e;return e=this.canvas.getBoundingClientRect(),t=t.originalEvent,t.type.indexOf("touch")!==-1?(i=t.touches[0].clientX-e.left,s=t.touches[0].clientY-e.top):(i=t.clientX-e.left,s=t.clientY-e.top),{x:i,y:s}},_renderCanvas:function(){this.drawing&&(this.ctx.moveTo(this.lastPos.x,this.lastPos.y),this.ctx.lineTo(this.currentPos.x,this.currentPos.y),this.ctx.stroke(),this.lastPos=this.currentPos)},_resetCanvas:function(){this.ctx=this.canvas.getContext("2d"),this.ctx.strokeStyle=this.settings.lineColor,this.ctx.lineWidth=this.settings.lineWidth},_resizeCanvas:function(){var t=this.$element.outerWidth(),i=this.$element.height();console.log(this.$element),this.$canvas.attr("width",t),this.$canvas.attr("height",i),this.$canvas.css("width",t+"px"),this.$canvas.css("height",i+"px")}},s.fn[n]=function(t){var i=arguments;if(void 0===t||"object"==typeof t)return this.each(function(){s.data(this,"plugin_"+n)||s.data(this,"plugin_"+n,new e(this,t))});if("string"==typeof t&&"_"!==t[0]&&"init"!==t){var a;return this.each(function(){var h=s.data(this,"plugin_"+n);h instanceof e&&"function"==typeof h[t]&&(a=h[t].apply(h,Array.prototype.slice.call(i,1))),"destroy"===t&&s.data(this,"plugin_"+n,null)}),void 0!==a?a:this}}}(window,document,jQuery);